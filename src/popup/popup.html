<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StorageFlow</title>
    <!-- Use the modular CSS files in correct order -->
    <link rel="stylesheet" href="styles/base.css" />
    <link rel="stylesheet" href="styles/layout.css" />
    <link rel="stylesheet" href="styles/components.css" />
    <link rel="stylesheet" href="styles/themes.css" />
    <link rel="stylesheet" href="styles/utilities.css" />
    <link rel="stylesheet" href="styles/main.css" />
    <link rel="stylesheet" href="styles/popup.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <div class="header-top">
          <div class="logo">
            <i class="fas fa-database text-2xl text-blue-200"></i>
            <h1>StorageFlow</h1>
          </div>
          <div class="header-actions">
            <button class="btn-icon" id="themeToggle" title="Toggle theme">
              <i class="fas fa-moon"></i>
            </button>
            <button class="btn-icon" id="githubBtn" title="View on GitHub">
              <i class="fab fa-github"></i>
            </button>
          </div>
        </div>
        <div class="header-bottom">
          <div class="storage-toggle">
            <div class="toggle-container">
              <span class="toggle-label" id="localLabel">Local</span>
              <input type="checkbox" id="storageToggle" class="toggle-input" />
              <label for="storageToggle" class="toggle-switch">
                <div class="toggle-slider"></div>
              </label>
              <span class="toggle-label" id="sessionLabel">Session</span>
            </div>
          </div>
          <div class="tab-info">
            <span id="currentTab">Loading...</span>
          </div>
        </div>
      </div>

      <!-- Navigation Tabs -->
      <div class="nav-tabs">
        <button class="nav-tab active" data-tab="manage">
          <i class="fas fa-edit"></i>
          Manage
        </button>
        <button class="nav-tab" data-tab="transfer">
          <i class="fas fa-exchange-alt"></i>
          Transfer
        </button>
        <button class="nav-tab" data-tab="settings">
          <i class="fas fa-cog"></i>
          Settings
        </button>
      </div>

      <!-- Manage Tab -->
      <div class="tab-content" id="manage-tab">
        <div class="mb-2">
          <div class="search-input">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Search keys..." />
            <button
              class="clear-search-btn"
              id="clearSearch"
              title="Clear search"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="flex gap-2 mb-2">
            <button
              class="btn-secondary"
              id="refreshBtn"
              title="Refresh storage data"
            >
              <i class="fas fa-sync-alt"></i>
            </button>
            <button class="btn-primary" id="addItemBtn">
              <i class="fas fa-plus"></i>
              Add
            </button>
            <button
              class="btn-primary"
              style="background-color: #059669"
              id="copyAllBtn"
              title="Copy all data to clipboard"
            >
              <i class="fas fa-copy"></i>
              Copy All
            </button>
            <button
              class="btn-primary"
              style="background-color: #7c3aed"
              id="pasteAllBtn"
              title="Paste data from clipboard"
            >
              <i class="fas fa-paste"></i>
              Paste All
            </button>
          </div>
        </div>

        <div class="stats-grid">
          <div class="stat-card stat-blue">
            <span class="text-xs font-medium flex-shrink-0">Total Keys:</span>
            <span class="text-sm font-bold ml-1 text-right" id="totalKeys"
              >0</span
            >
          </div>
          <div class="stat-card stat-green">
            <span class="text-xs font-medium flex-shrink-0">Storage Used:</span>
            <span class="text-sm font-bold ml-1 text-right" id="storageUsed"
              >0 KB</span
            >
          </div>
        </div>

        <!-- Bulk Actions (hidden by default) -->
        <div class="bulk-actions hidden" id="bulkActions">
          <div
            class="flex items-center justify-between p-3 bg-blue-50 rounded-lg"
          >
            <span id="selectedCount">0 selected</span>
            <div class="flex gap-2">
              <button class="btn-primary btn-sm" id="selectAll">
                Select All
              </button>
              <button
                class="btn-primary btn-sm"
                id="deleteSelected"
                style="background-color: #dc2626"
              >
                Delete
              </button>
              <button
                class="btn-primary btn-sm"
                id="exportSelected"
                style="background-color: #059669"
              >
                Export
              </button>
            </div>
          </div>
        </div>

        <div class="storage-items" id="storageItems">
          <!-- Storage items will be populated here -->
        </div>
      </div>

      <!-- Transfer Tab -->
      <div class="tab-content hidden" id="transfer-tab">
        <div class="space-y-4">
          <!-- Export Section -->
          <div class="card section-green">
            <h3 class="flex items-center gap-2 font-semibold mb-2">
              <i class="fas fa-upload"></i> Export Data
            </h3>
            <div class="flex gap-2 mb-2">
              <button class="btn-primary" id="exportBtn">
                <i class="fas fa-download"></i>
                Export All
              </button>
              <button class="btn-primary" id="exportSelectedBtn">
                <i class="fas fa-check-square"></i>
                Export Selected
              </button>
            </div>
            <div class="flex gap-2 mb-2">
              <button
                class="btn-primary"
                style="background-color: #059669"
                id="copyAllClipboardBtn"
                title="Copy all data to clipboard"
              >
                <i class="fas fa-copy"></i>
                Copy to Clipboard
              </button>
              <button
                class="btn-primary"
                style="background-color: #059669"
                id="copySelectedClipboardBtn"
                title="Copy selected data to clipboard"
              >
                <i class="fas fa-clipboard-check"></i>
                Copy Selected
              </button>
            </div>
            <div class="text-sm font-medium">
              <span id="selectedCount">0 items selected</span>
            </div>
          </div>

          <!-- Import Section -->
          <div class="card section-blue">
            <h3 class="flex items-center gap-2 font-semibold mb-2">
              <i class="fas fa-download"></i> Import Data
            </h3>
            <div class="file-upload mb-3" id="fileUpload">
              <i class="fas fa-cloud-upload-alt text-xl mb-1"></i>
              <p class="text-sm">
                Drop JSON file here or <span class="font-medium">browse</span>
              </p>
              <input type="file" id="fileInput" accept=".json" hidden />
            </div>

            <!-- Import Preview Section -->
            <div class="hidden" id="importPreview">
              <h4 class="font-semibold mb-2 text-sm">Preview Data:</h4>
              <div
                class="max-h-48 overflow-y-auto border rounded-md mb-3"
                id="importPreviewContainer"
              >
                <!-- Preview items will be populated here -->
              </div>
              <div class="flex gap-2 mb-3">
                <button class="btn-primary" id="confirmImportBtn">
                  <i class="fas fa-check"></i>
                  Confirm Import
                </button>
                <button class="btn-secondary" id="cancelImportBtn">
                  <i class="fas fa-times"></i>
                  Cancel
                </button>
              </div>
            </div>

            <div class="flex gap-2 mb-3" id="initialImportControls">
              <button class="btn-primary" id="importBtn">
                <i class="fas fa-upload"></i>
                Import
              </button>
            </div>
            <div class="space-y-2">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="overwriteExisting" checked />
                <span class="text-sm">Overwrite existing keys</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="backupBeforeImport" />
                <span class="text-sm">Create backup before import</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Settings Tab -->
      <div class="tab-content hidden" id="settings-tab">
        <div class="space-y-4">
          <!-- Appearance Section -->
          <div class="card section-purple">
            <h3 class="flex items-center gap-2 font-semibold mb-3">
              <i class="fas fa-palette"></i> Appearance
            </h3>
            <div class="space-y-3">
              <div class="flex items-center justify-between">
                <label class="font-medium text-sm">Theme</label>
                <select id="themeSelect" class="text-sm">
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                  <option value="auto">Auto</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Safety Section -->
          <div class="card section-orange">
            <h3 class="flex items-center gap-2 font-semibold mb-3">
              <i class="fas fa-shield-alt"></i> Safety
            </h3>
            <div class="space-y-2">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="confirmDelete" checked />
                <span class="text-sm">Confirm before deleting items</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="autoBackup" />
                <span class="text-sm">Auto backup before major changes</span>
              </label>
            </div>
          </div>

          <!-- Advanced Section -->
          <div class="card section-red">
            <h3 class="flex items-center gap-2 font-semibold mb-3">
              <i class="fas fa-tools"></i> Advanced
            </h3>
            <div class="space-y-2">
              <button
                class="w-full btn-primary text-sm"
                style="background-color: #dc2626"
                id="clearStorage"
              >
                <i class="fas fa-trash-alt"></i>
                Clear All Data
              </button>
              <button class="w-full btn-primary text-sm" id="exportSettingsBtn">
                <i class="fas fa-cog"></i>
                Export Settings
              </button>
            </div>
          </div>

          <!-- About Section -->
          <div class="card section-blue">
            <h3 class="flex items-center gap-2 font-semibold mb-3">
              <i class="fas fa-info-circle"></i> About StorageFlow
            </h3>
            <div class="space-y-3">
              <div class="text-sm">
                <p class="mb-2">
                  <strong>StorageFlow v2.0.0</strong> - Professional Browser
                  Storage Manager
                </p>
                <p class="text-xs opacity-80 mb-3">
                  Seamlessly manage localStorage & sessionStorage with
                  professional tools for import/export, editing, and cross-tab
                  data transfer.
                </p>
              </div>

              <!-- Social Links -->
              <div class="space-y-2">
                <div class="flex items-center justify-between text-sm">
                  <span class="font-medium">Connect with us:</span>
                </div>
                <div class="flex gap-2">
                  <button
                    class="btn-secondary text-xs social-link"
                    id="githubLink"
                    title="View source code"
                  >
                    <i class="fab fa-github"></i>
                    GitHub
                  </button>
                  <button
                    class="btn-secondary text-xs social-link"
                    id="issuesLink"
                    title="Report issues"
                  >
                    <i class="fas fa-bug"></i>
                    Issues
                  </button>
                  <button
                    class="btn-secondary text-xs social-link"
                    id="documentationLink"
                    title="View documentation"
                  >
                    <i class="fas fa-book"></i>
                    Docs
                  </button>
                </div>
                <div class="text-xs opacity-70 mt-2">
                  Made with ❤️ for developers and power users
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal for editing items -->
    <div class="modal hidden" id="editModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTitle">Edit Item</h3>
          <button class="modal-close" id="closeModal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="itemKey" class="form-label">Key</label>
            <input
              type="text"
              id="itemKey"
              class="form-input"
              placeholder="Enter key name"
            />
          </div>
          <div class="form-group">
            <label for="itemValue" class="form-label">Value</label>
            <textarea
              id="itemValue"
              class="form-input"
              rows="6"
              placeholder="Enter value"
            ></textarea>
          </div>
          <div class="flex gap-2 mt-4">
            <button class="btn-secondary flex-1" id="cancelBtn">Cancel</button>
            <button class="btn-primary flex-1" id="saveBtn">Save</button>
            <button class="btn-danger hidden" id="deleteBtn">Delete</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Paste Input Modal -->
    <div class="modal hidden" id="pasteInputArea">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Paste JSON Data</h3>
          <button class="modal-close" id="closePasteModal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="pasteInput" class="form-label">JSON Data</label>
            <textarea
              id="pasteInput"
              class="form-input"
              rows="8"
              placeholder="Paste your JSON data here (Ctrl+V)..."
            ></textarea>
          </div>
          <div class="flex gap-2 mt-4">
            <button class="btn-secondary flex-1" id="cancelPasteBtn">
              Cancel
            </button>
            <button class="btn-primary flex-1" id="processPasteBtn">
              Import Data
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Import Item Edit Modal -->
    <div class="modal hidden" id="importEditModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Edit Import Item</h3>
          <button class="modal-close" id="closeImportEditModal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="importItemKey" class="form-label">Key</label>
            <input
              type="text"
              id="importItemKey"
              class="form-input"
              placeholder="Enter key name"
            />
          </div>
          <div class="form-group">
            <label for="importItemValue" class="form-label">Value</label>
            <textarea
              id="importItemValue"
              class="form-input"
              rows="6"
              placeholder="Enter value"
            ></textarea>
          </div>
          <div class="flex gap-2 mt-4">
            <button class="btn-secondary flex-1" id="cancelImportEditBtn">
              Cancel
            </button>
            <button class="btn-primary flex-1" id="saveImportEditBtn">
              Save
            </button>
            <button class="btn-danger" id="deleteImportItemBtn">Delete</button>
          </div>
        </div>
      </div>
    </div>

    <script src="popup-controller.js"></script>
  </body>
</html>
